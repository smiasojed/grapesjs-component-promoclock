/*! grapesjs-component-promoclock - 0.0.4 */
!function(e,o){"object"==typeof exports&&"object"==typeof module?module.exports=o(require("grapesjs")):"function"==typeof define&&define.amd?define(["grapesjs"],o):"object"==typeof exports?exports["grapesjs-component-promoclock"]=o(require("grapesjs")):e["grapesjs-component-promoclock"]=o(e.grapesjs)}("undefined"!=typeof self?self:this,function(e){return function(e){function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}var t={};return o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},o.p="",o(o.s=1)}([function(e,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0});o.promoclockRef="promoclock"},function(e,o,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(o,"__esModule",{value:!0});var r=t(2),c=n(r),a=t(3),l=n(a),i=t(4),s=n(i),d=t(0);o.default=c.default.plugins.add("gjs-component-promoclock",function(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=o,n={blocks:[d.promoclockRef],defaultStyle:!0,cookie:"promoClockCookie",expires:"100",endText:"EXPIRED",duration:"",redirect:"",dateInputType:"date",promoclockClsPfx:"promoclock",labelPromoclock:"Promoclock",labelPromoclockCategory:"Extra",labelDays:"days",labelHours:"hours",labelMinutes:"minutes",labelSeconds:"seconds"};for(var r in n)r in t||(t[r]=n[r]);(0,l.default)(e,t),(0,s.default)(e,t)})},function(o,t){o.exports=e},function(e,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n=Object.assign||function(e){for(var o=1;o<arguments.length;o++){var t=arguments[o];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e};o.default=function(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=o,r=e.DomComponents,c=r.getType("default"),a=r.getType("text"),l=c.model,i=c.view,s=(a.model,a.view,t.promoclockClsPfx);r.addType("promoclock",{model:l.extend({defaults:n({},l.prototype.defaults,{duration:t.duration,cookie:t.cookie,expires:t.expires,endText:t.endText,redirect:t.redirect,droppable:!1,traits:[{label:"Duration",name:"duration",changeProp:1},{label:"Cookie name",name:"cookie",changeProp:1},{label:"Cookie validity",name:"expires",changeProp:1},{label:"End text",name:"endText",changeProp:1},{label:"Redirect to",name:"redirect",changeProp:1}],script:function(){var e=this.querySelector("[data-js=promoclock]"),o=this.querySelector("[data-js=promoclock-endtext]"),t=this.querySelector("[data-js=promoclock-day]"),n=this.querySelector("[data-js=promoclock-hour]"),r=this.querySelector("[data-js=promoclock-minute]"),c=this.querySelector("[data-js=promoclock-second]"),a=this.gjs_promoclock_interval,l=24*Number("{[ duration ]}")*60*60*1e3;a&&a&&clearInterval(a);var i=function(e,o,a,l){t.innerHTML=e<10?"0"+e:e,n.innerHTML=o<10?"0"+o:o,r.innerHTML=a<10?"0"+a:a,c.innerHTML=l<10?"0"+l:l},s=function(){var t=(new Date).getTime(),n=d-t,r=Math.floor(n/864e5),c=Math.floor(n%864e5/36e5),a=Math.floor(n%36e5/6e4),l=Math.floor(n%6e4/1e3);i(r,c,a,l),n<0&&(clearInterval(u),o.innerHTML="{[ endText ]}",e.style.display="none",o.style.display="",window.location.replace("{[ redirect ]}"))};if(l){var d=Date.now()+l,p=function(e){var o=document.cookie.match(new RegExp("(^| )"+e+"=([^;]+)"));return o?o[2]:""}("{[ cookie ]}");""===p?function(e,o,t){var n="";if(t){var r=new Date;r.setTime(r.getTime()+24*t*60*60*1e3),n="; expires="+r.toUTCString()}document.cookie=e+"="+(o||"")+n+"; path=/"}("{[ cookie ]}",d,Number("{[ expires ]}")):d=Number(p);var u=setInterval(s,1e3);this.gjs_promoclock_interval=u,o.style.display="none",e.style.display="",s()}else i(0,0,0,0)}})},{isComponent:function(e){if(e.getAttribute&&"promoclock"==e.getAttribute("data-gjs-type"))return{type:"promoclock"}}}),view:i.extend({init:function(){this.listenTo(this.model,"change:duration change:cookie change:expires",function(){return document.cookie.split(";").forEach(function(e){document.cookie=e.replace(/^ +/,"").replace(/=.*/,"=;expires="+(new Date).toUTCString()+";path=/")})}),this.listenTo(this.model,"change:expires change:cookie change:endText change:duration change:redirect",this.updateScript);var e=this.model.get("components");e.length||(e.reset(),e.add('\n            <span data-js="promoclock" class="'+s+'-cont">\n              <div class="'+s+'-block">\n                <div data-js="promoclock-day" class="'+s+'-digit"></div>\n                <div class="'+s+'-label">'+t.labelDays+'</div>\n              </div>\n              <div class="'+s+'-block">\n                <div data-js="promoclock-hour" class="'+s+'-digit"></div>\n                <div class="'+s+'-label">'+t.labelHours+'</div>\n              </div>\n              <div class="'+s+'-block">\n                <div data-js="promoclock-minute" class="'+s+'-digit"></div>\n                <div class="'+s+'-label">'+t.labelMinutes+'</div>\n              </div>\n              <div class="'+s+'-block">\n                <div data-js="promoclock-second" class="'+s+'-digit"></div>\n                <div class="'+s+'-label">'+t.labelSeconds+'</div>\n              </div>\n            </span>\n            <span data-js="promoclock-endtext" class="'+s+'-endtext"></span>\n          '))}})})}},function(e,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=o,r=e.BlockManager,c=t.promoclockClsPfx,a=t.defaultStyle?"<style>\n    ."+c+" {\n      text-align: center;\n      font-family: Helvetica, serif;\n    }\n\n    ."+c+"-block {\n      display: inline-block;\n      margin: 0 10px;\n      padding: 10px;\n    }\n\n    ."+c+"-digit {\n      font-size: 5rem;\n    }\n\n    ."+c+"-endtext {\n      font-size: 5rem;\n    }\n\n    ."+c+"-cont,\n    ."+c+"-block {\n      display: inline-block;\n    }\n  </style>":"";t.blocks.indexOf(n.promoclockRef)>=0&&r.add(n.promoclockRef,{label:t.labelPromoclock,category:t.labelPromoclockCategory,attributes:{class:"fa fa-clock-o"},content:'\n        <div class="'+c+'" data-gjs-type="promoclock"></div>\n        '+a+"\n      "})};var n=t(0)}])});